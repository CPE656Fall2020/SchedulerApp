<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Scheduler Import Tools Overview </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Scheduler Import Tools Overview ">
    <meta name="generator" content="docfx 2.45.1.0">
    
    <link rel="shortcut icon" href="../images/satellite_small.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/satellite_ico.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="scheduler-import-tools-overview">Scheduler Import Tools Overview</h1>

<p>The Import Tools are a collection of components designed to allow for flexible data imports from Excel Spreadsheets into the database of device profiles used for scheduling. The Import Tools project contains components in two main categories:</p>
<ol>
<li><strong>Command Line Import Tools</strong>. The CLI import tools are designed for automated and scripted import processes where a database needs to be built up quickly from a collection of source data.</li>
<li><strong>Backend Import API Components</strong>. The import API is designed to allow for flexible programatic data import. These components are used by the CLI tools to form the fully-standalone import tools. This API is also exported and used in the main Scheduler Application GUI for interactive data importing.</li>
</ol>
<h2 id="import-modes">Import Modes</h2>
<p>Currently, only importing data from Excel Spreadsheets using a JSON map is supported.</p>
<h3 id="excel-import-provider-excelworksheetimporter">Excel Import Provider (<code>ExcelWorksheetImporter</code>)</h3>
<p>The Excel Import Provider provides translation from data in xls and xlsx files to SQL, as controlled by a JSON map. The JSON map allows for dynamically mapping which fields in the spreadsheet correspond to which columns in the database. Map files also allow for defining constant values, which can simplify the layout of Excel sheets when many iterations of an experiment may all share common parameters. Map files also provide support for applying a scaling factor to most imported parameters, which can simplify the process when specific tools are configured to produce test-data in non-standard units (such as TI's EnergyTrace emitted energy usage in microJoules, milliVolts, and microAmps, as opposed to Joules, Volts, and Amps units used by the UM25C inline USB power meter). The format for the JSON maps is outlined in the following section.</p>
<h2 id="json-maps">JSON Maps</h2>
<p><em><strong>Sample JSON Map Format</strong></em></p>
<pre><code class="lang-json">{
  &quot;ProfileType&quot;: &quot;&lt;the name of the profile type&gt;&quot;,
  &quot;ProfileId&quot;: &quot;&lt;A randomly generated GUID to identify this data entry&gt;&quot;,
  
  &quot;key&quot;: &quot;&lt;value&gt;&quot;,
  ...
  &quot;key&quot;: &quot;&lt;value&gt;&quot;
}
</code></pre>
<p>For the <code>ProfileType</code> field, the class-name of the profile being imported must be entered exactly as it is shown in code in the <code>SchedulerDatabase.Models</code> namespace. Currently, the available options are:</p>
<ul>
<li><code>AESEncryptorProfile</code></li>
<li><code>CompressorProfile</code></li>
</ul>
<p>Each imported entry must also be assigned a unique GUID to serve as a primary key in the database. If left empty, a random GUID will be assigned automatically. However, it is recommended to manually generate a random value for the GUID and store it in the Excel sheet with the data. This allows for merging corrected spreadsheets into an existing database without having to completely rebuild it, since changes can be matched and made using the unique GUID.</p>
<p>Since the particular columns for each profile type differ, and this program is designed to be modular for future use cases, the remainder of the JSON map format is not hard coded. As many (key, value) pairs as needed can be added to match the profile type being imported.</p>
<h3 id="constant-values">Constant Values</h3>
<p>For constant values in the JSON map, the appropriate value can be entered as it would be in any other JSON document. For example, in the <code>AESEncryptorProfile</code>, to setup a test as being marked as done with OpenSSL, the following entry can be used:</p>
<pre><code class="lang-json">{
  &quot;ProviderName&quot;: &quot;OpenSSL-CLI&quot;
}
</code></pre>
<h3 id="dynamic-values">Dynamic Values</h3>
<p>To reference a particular parameter in the map file to a specific cell reference in Excel, set the value equal to a string constant with the Excel Cell Identifier. For example, to refer to Row 2, Column C, the correct identifier would be &quot;C2&quot;, including the quotation marks. For example, to read the Average Voltage Reading for an experiment from the cell H16, the following entry would be used:</p>
<pre><code class="lang-json">{
  &quot;AverageVoltage&quot;: &quot;H16&quot;
}
</code></pre>
<h3 id="scaled-values">Scaled Values</h3>
<p>A multiplicative scaling factor can be applied to Dynamic Values in order to convert them into the expected units. Typically, all units are expected to be in SI base units, such as Volts, Amps, and Joules. For example, to convert a reading of millivolts to volts, nanoamps to amps, the following scaling entries can be used:</p>
<pre><code class="lang-json">{
  &quot;AverageVoltage&quot;: [ &quot;J8&quot;, 0.001 ],
  &quot;AverageCurrent&quot;: [ &quot;J7&quot;, 1e-9 ],
}
</code></pre>
<p>As shown, 0.01 (or 1e-3) and 1e-9 are the metric scaling factors for milli and nano, respectively. The value present in cells J7 and J8 will each be scaled by 1e-3 and 1e-9 (respectively) before being stored in the database.</p>
<h2 id="database-setup">Database Setup</h2>
<p>The Scheduler Import Tools rely upon SchedulerDatabase for all database connectivity.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/CPE656Fall2020/SchedulerApp/blob/c2eea1e45698a50ecf32259b10368f7de9667592/docs/articles/import_overview.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
